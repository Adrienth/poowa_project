<!doctype html>
<title>{% block title %}{% endblock %} - MyShows</title>
<link rel="shortcut icon" href="{{ url_for('static', filename='tvshow.png') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='style.css')}}">
<!-- Load icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<nav>
    <h1>MyShows</h1>
    <ul>
        {% if session['user_id'] %}
        <li><span> Logged in as {{ session['user_name'].capitalize() }}</span>
        <li><a href="{{ url_for('auth.logout') }}">Log Out</a>
            {% else %}
        <li><a href="{{ url_for('auth.register') }}">Register</a>
        <li><a href="{{ url_for('auth.login') }}">Log In</a>
            {% endif %}
    </ul>
</nav>


<section class="content">
    <header>
        {% block header %}
        {% if session['user_id'] %}
        <a class="action" href="{{ url_for('myfav.get_my_fav')}}">My Favourites</a>
        {% endif %}
        {% endblock %}
    </header>

    {% for message in get_flashed_messages() %}
    <div class="flash">{{ message }}</div>
    {% endfor %}


    {% block content %}{% endblock %}

    {% for result in results %}
    <article class="result">
        <div class="flex-container">
            <div class="poster" style="flex-grow: 1">
                {% if result['poster_url'] %}
                <img src="{{ result['poster_url'] }}" style="width:165px;height:250px;float:center" alt="'{{ result['title'] }}' poster">
                {% else %}
                <img src="https://www.scenebyte.com/images/no_poster.jpg" style="width:165px;height:250px;float:center" alt="No poster available">
                {% endif %}
            </div>

            <div style="flex-grow: 7">
            {% if session['user_id'] %}
            {% if result['id'] in session['show_ids'] %}
            <a href="{{ url_for('search.rm_from_fav',show_id=result['id'], name=result['title'] ) }}" title="Remove '{{ result['title'] }}' from favourites" class="hearticon">
                <i class="fa fa-heart"></i>
            </a>
            {% else %}
            <a href="{{ url_for('search.add_to_fav',show_id=result['id'], name=result['title'] ) }}" title="Add '{{ result['title'] }}' to favourites" class="hearticon" >
                <i class="fa fa-heart-o"></i>
            </a>
            {% endif %}
            {% endif %}
            <header>
                <div>
                    <h1>{{ result['title'] }}</h1>
                    <div class="about">First aired on {{ result['date'] }} | {{ result['vote_average'] }} <i class="fa fa-star gradient-icon"></i></div>
                </div>

            </header>
            <p class="body">{{ result['trunc_overview'] }}</p>
            </div>
        </div>
    </article>
    {% if not loop.last %}
    <hr>
    {% endif %}
    {% endfor %}
</section>